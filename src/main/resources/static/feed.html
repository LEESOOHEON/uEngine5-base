<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>


    <script src="https://unpkg.com/vue"></script>
    <script src="https://unpkg.com/vue-material@0.7.1"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.3/require.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/vue-material@0.7.1/dist/vue-material.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">



</head>
<body>

<script>

    Vue.use(VueMaterial)

</script>


<script src="http://rawgit.com/TheOpenCloudEngine/metaworks4/master/src/main/resources/static/object-grid.js"></script>
<script src="http://rawgit.com/TheOpenCloudEngine/metaworks4/master/src/main/resources/static/object-form.js"></script>
<script src="service-locator.js"></script>
<script src="http://rawgit.com/TheOpenCloudEngine/metaworks4/master/src/main/resources/static/class-selector.js"></script>

<script src="http://rawgit.com/TheOpenCloudEngine/metaworks4/master/src/main/resources/static/iam-client/jqeury.js" charset="utf-8"></script>
<script src="http://rawgit.com/TheOpenCloudEngine/metaworks4/master/src/main/resources/static/iam-client/iam-client.js" charset="utf-8"></script>
<script src="http://rawgit.com/TheOpenCloudEngine/metaworks4/master/src/main/resources/static/iam-login.js"></script>

<script src="ssp-class.js"></script>

<div id="app">

    <iam-login iam-server="http://iam.uengine.io:8080" ref="login" :listener="$root" v-if="!loggedIn" id="jyjang@uengine.org" password="test"></iam-login>

    <service-locator host="http://localhost:8080" ref="backend" path="instances"></service-locator>

    <div v-if="loggedIn">
        <form novalidate @submit.stop.prevent="submit">
            <md-input-container>
                <label>새로운 주제</label>
                <md-input v-model="title"></md-input>
            </md-input-container>
            <md-button @click.native="send">게시</md-button>
        </form>

        <md-list class="custom-list md-triple-line">
            <md-list-item v-for="item in feed">
                <md-avatar>
                    <img src="https://placeimg.com/40/40/people/1" alt="People">
                </md-avatar>

                <div class="md-list-text-container">
                    <span>{{item.name}}</span>
                    <p>{{item.lastCmnt}}</p>
                    <p>{{item.lastCmnt2}}</p>
                </div>

                <md-button class="md-icon-button md-list-action">
                    <md-icon class="md-primary">star</md-icon>
                </md-button>

                <md-divider class="md-inset"></md-divider>
            </md-list-item>
        </md-list>
    </div>

</div>

<script>

    var app = new Vue({
        el: '#app',
        props: {loggedIn: Boolean},
        data: {
          feed:[],
            title: ''

        },
        methods: {

            onLoggedIn: function(){
                this.loggedIn = true;
                var me = this;

                this.$root.$refs['backend'].invoke({
                    query: {"sort": "moddate,desc"},
                    success: function(data){
                        me.feed = data._embedded.instances;
                    }
                });


            },

            send: function(){

                this.$root.$refs['backend'].invoke({
                    method: "POST",
                    data: {
                        name: this.title,
                        lastCmnt: this.title,

                        roleMappings: [{
                            name: 'initiator',
                            endpoint: 'jyjang'
                        }],
                        workLists: [{

                        }]

                    }
                });

            }


        }

    })


</script>






</body>
</html>